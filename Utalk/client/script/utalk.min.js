"use strict";!function(){function e(){var e=i.getDate(s.from,s.to,s.message);e.hasOwnProperty("command")?"@"==e.command&&e.m.trim().length>0?i.sendMessage(e,function(e){i.showMessage(n,e,!a),i.clearInput([s.message],s.message)}):">"==e.command&&i.searchBaiduImage(e.m,function(t){var o=i.formatImageSet(t);e.m=t,i.sendLocalSearch(e,function(e){e.m=o,console.log(e),i.showSearchResult(n,e),i.clearInput([s.message],s.message)})}):e.m.trim().length>0&&i.sendMessage(e,function(e){i.showMessage(n,e,!a),i.clearInput([s.message],s.message)})}var t=document.getElementById("set"),n=document.getElementById("message_box"),s=document.getElementById("input"),o=document.getElementById("shadow"),a=!0,c=!1,i={},l={};if(localStorage.getItem("nick")){var m=localStorage.getItem("nick");document.getElementById("nick").value=m,document.getElementById("nick").focus()}o.addEventListener("click",function(){t.nick.focus()}),t.addEventListener("submit",function(e){e.preventDefault();var c=t.nick.value.trim();c.length>=5?(l=io("http://localhost:3000/"),l.on("connect",function(){i=new utalk.wsHandle(l,c),l.emit("regist",c,function(e){switch(e.code){case 0:t.nick.placeholder=e.m,t.nick.value="",t.nick.focus();break;case 1:localStorage.setItem("nick",c),o.style.opacity=0,s.from.value=c,s.message.focus(),setTimeout(function(){o.style.display="none"},505)}}),i.getClients(s.to),i.listen("message",function(e){i.showMessage(n,e,a)}),i.listen("new_user",function(){i.getClients(s.to)}),i.listen("user_not_in",function(e){i.showMessage(n,e,a)})})):(t.nick.placeholder="Try 5-20 letter",t.nick.value="",t.nick.focus())}),s.addEventListener("submit",function(t){t.preventDefault(),e()}),message.addEventListener("keydown",function(t){"16"!=t.keyCode||c||(c=!0),"13"!=t.keyCode||c||(t.preventDefault(),e()),"13"==t.keyCode&&c&&(t.preventDefault(),s.message.value+="\n",s.message.scrollTop=s.message.scrollHeight)}),message.addEventListener("keyup",function(e){"16"==e.keyCode&&(c=!1)})}();
//# sourceMappingURL=utalk.min.js.map
